#### Simple JavaScript malware code obfuscation examples

A couple of days ago my colleague form my company founds a piece of malicious JavaScript on his Windows machine. Luckily, it did not run and did not harm his system.

I decided to take a look at it and go through the code. Below is some of simple, but still interesting methods to obfuscate JavaScript code.

#### First look

If you open file ```do_not_run.js``` in this repository (and I strongly suggest you not to run it if you're on Windows machine :) ) - you'll see a big mess. Hard to read, hard to figure out what's going on - but still valid and working JavaScript.

How it's even possible?

#### Entry point

Everything starts from top-level IIFE (Immediately Invoked Function Expression). This is a way to run code in JavaScript (eg. function) without calling it directly.

Consider example:

```javascript
function hello(message) {
	console.log(message)
}
```

If you try to run this code, nothing will happen. To make it work, you have to call function ```hello()``` passing some message to it:

```javascript
function hello(message) {
	console.log(message)
}

hello('This is test')
```

Now, you should be able to see ```This is test``` message displayed.

Let's make IIFE from this code:

```javascript
(function hello(message) {
	console.log(message)
})('This is test')
```

And here's some magic - even without calling ```hello()``` function, this piece of code works. How it's possible?

* parenthesis around function definition makes a valid JavaScript expression from it. Expression is the simplest piece of code returns some value (like ```2+2```).
* parenthesis with ```This is test``` __runs__ the function passing an argument to it. Technically, ```(fn(x){})(x)``` is equivalent of ```fn(x)``` definition and call in one.


https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20%26%20closures/ch3.md#invoking-function-expressions-immediately


In our malware sample we have similar call:

```javascript
(function(quhuvu6) {

	// ...
	
}("41553a304f0b442551284206" + "672651014d1e1a60127" + ...```

This causes malware runs on its own passing some very, very long ASCII string as an argument for IIFE function.


